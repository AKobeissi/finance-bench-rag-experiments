2025-11-12 09:05:48,406 - evaluator - INFO - SacreBLEU initialized successfully
2025-11-12 09:05:48,460 - absl - INFO - Using default tokenizer.
2025-11-12 09:05:48,460 - evaluator - INFO - ROUGE scorer initialized successfully
2025-11-12 09:05:48,460 - evaluator - INFO - Evaluator initialized - BLEU: True, ROUGE: True, BERTScore: False, LLM Judge: False
2025-11-12 09:05:48,461 - RAGExperiment - INFO - ================================================================================
2025-11-12 09:05:48,461 - RAGExperiment - INFO - INITIALIZING RAG EXPERIMENT: SINGLE_VECTOR
2025-11-12 09:05:48,461 - RAGExperiment - INFO - ================================================================================
2025-11-12 09:05:48,461 - RAGExperiment - INFO - Configuration:
2025-11-12 09:05:48,461 - RAGExperiment - INFO -   Experiment Type: single_vector
2025-11-12 09:05:48,461 - RAGExperiment - INFO -   LLM Model: meta-llama/Llama-3.2-3B-Instruct
2025-11-12 09:05:48,461 - RAGExperiment - INFO -   Judge Model: Disabled
2025-11-12 09:05:48,461 - RAGExperiment - INFO -   Device: cuda
2025-11-12 09:05:48,461 - RAGExperiment - INFO -   8-bit Loading: True
2025-11-12 09:05:48,461 - RAGExperiment - INFO -   Chunk Size: 512
2025-11-12 09:05:48,461 - RAGExperiment - INFO -   Chunk Overlap: 50
2025-11-12 09:05:48,461 - RAGExperiment - INFO -   Top-K Retrieval: 3
2025-11-12 09:05:48,461 - RAGExperiment - INFO -   Embedding Model: sentence-transformers/all-MiniLM-L6-v2
2025-11-12 09:05:48,461 - RAGExperiment - INFO -   Max New Tokens: 256
2025-11-12 09:05:48,461 - RAGExperiment - INFO -   Using LangChain + FAISS + HuggingFace LLMs
2025-11-12 09:05:48,461 - RAGExperiment - INFO - ================================================================================
2025-11-12 09:05:48,462 - RAGExperiment - INFO - 
Initializing LangChain components...
2025-11-12 09:05:48,462 - RAGExperiment - INFO - Loading embeddings: sentence-transformers/all-MiniLM-L6-v2
2025-11-12 09:05:48,464 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-11-12 09:05:48,476 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2025-11-12 09:05:48,900 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /sentence-transformers/all-MiniLM-L6-v2/resolve/main/modules.json HTTP/1.1" 307 0
2025-11-12 09:05:49,092 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/modules.json HTTP/1.1" 200 0
2025-11-12 09:05:49,316 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /sentence-transformers/all-MiniLM-L6-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 307 0
2025-11-12 09:05:49,507 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/config_sentence_transformers.json HTTP/1.1" 200 0
2025-11-12 09:05:49,715 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /sentence-transformers/all-MiniLM-L6-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 307 0
2025-11-12 09:05:49,828 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/config_sentence_transformers.json HTTP/1.1" 200 0
2025-11-12 09:05:50,034 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /sentence-transformers/all-MiniLM-L6-v2/resolve/main/README.md HTTP/1.1" 307 0
2025-11-12 09:05:50,229 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/README.md HTTP/1.1" 200 0
2025-11-12 09:05:50,449 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /sentence-transformers/all-MiniLM-L6-v2/resolve/main/modules.json HTTP/1.1" 307 0
2025-11-12 09:05:50,563 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/modules.json HTTP/1.1" 200 0
2025-11-12 09:05:50,771 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /sentence-transformers/all-MiniLM-L6-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 307 0
2025-11-12 09:05:50,962 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/sentence_bert_config.json HTTP/1.1" 200 0
2025-11-12 09:05:51,170 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /sentence-transformers/all-MiniLM-L6-v2/resolve/main/adapter_config.json HTTP/1.1" 404 0
2025-11-12 09:05:51,377 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /sentence-transformers/all-MiniLM-L6-v2/resolve/main/config.json HTTP/1.1" 307 0
2025-11-12 09:05:51,576 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/config.json HTTP/1.1" 200 0
2025-11-12 09:05:52,353 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /sentence-transformers/all-MiniLM-L6-v2/resolve/main/tokenizer_config.json HTTP/1.1" 307 0
2025-11-12 09:05:52,546 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/tokenizer_config.json HTTP/1.1" 200 0
2025-11-12 09:05:52,824 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/sentence-transformers/all-MiniLM-L6-v2/tree/main/additional_chat_templates?recursive=False&expand=False HTTP/1.1" 404 64
2025-11-12 09:05:53,154 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /sentence-transformers/all-MiniLM-L6-v2/resolve/main/1_Pooling/config.json HTTP/1.1" 307 0
2025-11-12 09:05:53,350 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/1_Pooling%2Fconfig.json HTTP/1.1" 200 0
2025-11-12 09:05:53,566 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/sentence-transformers/all-MiniLM-L6-v2 HTTP/1.1" 200 6861
2025-11-12 09:05:54,510 - RAGExperiment - INFO - ✓ Embeddings loaded
2025-11-12 09:05:54,510 - RAGExperiment - INFO - ✓ Text splitter initialized (chunk_size=512, overlap=50)
2025-11-12 09:05:54,510 - RAGExperiment - INFO - 
================================================================================
2025-11-12 09:05:54,510 - RAGExperiment - INFO - STARTING EXPERIMENT
2025-11-12 09:05:54,510 - RAGExperiment - INFO - ================================================================================
2025-11-12 09:05:54,510 - data_loader - INFO - Loading FinanceBench dataset: PatronusAI/financebench, split: train
2025-11-12 09:05:54,721 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /datasets/PatronusAI/financebench/resolve/main/README.md HTTP/1.1" 307 0
2025-11-12 09:05:54,914 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /api/resolve-cache/datasets/PatronusAI/financebench/e04404e3a97f69f79c14d42f24981a1c9c3bcd18/README.md HTTP/1.1" 200 0
2025-11-12 09:05:55,148 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /datasets/PatronusAI/financebench/resolve/e04404e3a97f69f79c14d42f24981a1c9c3bcd18/financebench.py HTTP/1.1" 404 0
2025-11-12 09:05:55,153 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): s3.amazonaws.com:443
2025-11-12 09:05:55,337 - urllib3.connectionpool - DEBUG - https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/PatronusAI/financebench/PatronusAI/financebench.py HTTP/1.1" 404 0
2025-11-12 09:05:55,601 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/datasets/PatronusAI/financebench/revision/e04404e3a97f69f79c14d42f24981a1c9c3bcd18 HTTP/1.1" 200 1277
2025-11-12 09:05:55,809 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /datasets/PatronusAI/financebench/resolve/e04404e3a97f69f79c14d42f24981a1c9c3bcd18/.huggingface.yaml HTTP/1.1" 404 0
2025-11-12 09:05:55,814 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): datasets-server.huggingface.co:443
2025-11-12 09:05:56,184 - urllib3.connectionpool - DEBUG - https://datasets-server.huggingface.co:443 "GET /info?dataset=PatronusAI/financebench HTTP/1.1" 200 None
2025-11-12 09:05:56,429 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/datasets/PatronusAI/financebench/tree/e04404e3a97f69f79c14d42f24981a1c9c3bcd18/data?recursive=True&expand=False HTTP/1.1" 404 79
2025-11-12 09:05:56,650 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/datasets/PatronusAI/financebench/tree/e04404e3a97f69f79c14d42f24981a1c9c3bcd18?recursive=False&expand=False HTTP/1.1" 200 312
2025-11-12 09:05:56,876 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /datasets/PatronusAI/financebench/resolve/e04404e3a97f69f79c14d42f24981a1c9c3bcd18/dataset_infos.json HTTP/1.1" 404 0
2025-11-12 09:05:56,884 - filelock - DEBUG - Attempting to acquire lock 140094494085136 on /u/kobeissa/.cache/huggingface/datasets/_u_kobeissa_.cache_huggingface_datasets_PatronusAI___financebench_default_0.0.0_e04404e3a97f69f79c14d42f24981a1c9c3bcd18.lock
2025-11-12 09:05:56,887 - filelock - DEBUG - Lock 140094494085136 acquired on /u/kobeissa/.cache/huggingface/datasets/_u_kobeissa_.cache_huggingface_datasets_PatronusAI___financebench_default_0.0.0_e04404e3a97f69f79c14d42f24981a1c9c3bcd18.lock
2025-11-12 09:05:56,890 - fsspec.local - DEBUG - open file: /u/kobeissa/.cache/huggingface/datasets/PatronusAI___financebench/default/0.0.0/e04404e3a97f69f79c14d42f24981a1c9c3bcd18/dataset_info.json
2025-11-12 09:05:56,892 - filelock - DEBUG - Attempting to release lock 140094494085136 on /u/kobeissa/.cache/huggingface/datasets/_u_kobeissa_.cache_huggingface_datasets_PatronusAI___financebench_default_0.0.0_e04404e3a97f69f79c14d42f24981a1c9c3bcd18.lock
2025-11-12 09:05:56,892 - filelock - DEBUG - Lock 140094494085136 released on /u/kobeissa/.cache/huggingface/datasets/_u_kobeissa_.cache_huggingface_datasets_PatronusAI___financebench_default_0.0.0_e04404e3a97f69f79c14d42f24981a1c9c3bcd18.lock
2025-11-12 09:05:56,894 - filelock - DEBUG - Attempting to acquire lock 140094494107408 on /u/kobeissa/.cache/huggingface/datasets/PatronusAI___financebench/default/0.0.0/e04404e3a97f69f79c14d42f24981a1c9c3bcd18_builder.lock
2025-11-12 09:05:56,896 - filelock - DEBUG - Lock 140094494107408 acquired on /u/kobeissa/.cache/huggingface/datasets/PatronusAI___financebench/default/0.0.0/e04404e3a97f69f79c14d42f24981a1c9c3bcd18_builder.lock
2025-11-12 09:05:56,896 - fsspec.local - DEBUG - open file: /u/kobeissa/.cache/huggingface/datasets/PatronusAI___financebench/default/0.0.0/e04404e3a97f69f79c14d42f24981a1c9c3bcd18/dataset_info.json
2025-11-12 09:05:56,897 - filelock - DEBUG - Attempting to release lock 140094494107408 on /u/kobeissa/.cache/huggingface/datasets/PatronusAI___financebench/default/0.0.0/e04404e3a97f69f79c14d42f24981a1c9c3bcd18_builder.lock
2025-11-12 09:05:56,898 - filelock - DEBUG - Lock 140094494107408 released on /u/kobeissa/.cache/huggingface/datasets/PatronusAI___financebench/default/0.0.0/e04404e3a97f69f79c14d42f24981a1c9c3bcd18_builder.lock
2025-11-12 09:05:57,040 - data_loader - INFO - Successfully loaded 150 examples
2025-11-12 09:05:57,040 - data_loader - INFO - Columns available: ['financebench_id', 'company', 'doc_name', 'question_type', 'question_reasoning', 'domain_question_num', 'question', 'answer', 'justification', 'dataset_subset_label', 'evidence', 'gics_sector', 'doc_type', 'doc_period', 'doc_link']
2025-11-12 09:05:57,040 - data_loader - INFO - ================================================================================
2025-11-12 09:05:57,040 - data_loader - INFO - DATASET STATISTICS
2025-11-12 09:05:57,040 - data_loader - INFO - ================================================================================
2025-11-12 09:05:57,040 - data_loader - INFO - Total examples: 150
2025-11-12 09:05:57,040 - data_loader - INFO - Columns: ['financebench_id', 'company', 'doc_name', 'question_type', 'question_reasoning', 'domain_question_num', 'question', 'answer', 'justification', 'dataset_subset_label', 'evidence', 'gics_sector', 'doc_type', 'doc_period', 'doc_link']
2025-11-12 09:05:57,073 - data_loader - INFO - ✓ Column 'question' present
2025-11-12 09:05:57,073 - data_loader - INFO - ✓ Column 'answer' present
2025-11-12 09:05:57,073 - data_loader - INFO - ✓ Column 'evidence' present
2025-11-12 09:05:57,073 - data_loader - INFO - ✓ Column 'doc_name' present
2025-11-12 09:05:57,082 - data_loader - INFO - 
Question lengths:
2025-11-12 09:05:57,082 - data_loader - INFO -   Mean: 161.09 chars
2025-11-12 09:05:57,082 - data_loader - INFO -   Min: 44 chars
2025-11-12 09:05:57,082 - data_loader - INFO -   Max: 592 chars
2025-11-12 09:05:57,107 - data_loader - INFO -   Median: 137.50 chars
2025-11-12 09:05:57,107 - data_loader - INFO - 
Answer lengths:
2025-11-12 09:05:57,107 - data_loader - INFO -   Mean: 78.19 chars
2025-11-12 09:05:57,107 - data_loader - INFO -   Min: 1 chars
2025-11-12 09:05:57,107 - data_loader - INFO -   Max: 609 chars
2025-11-12 09:05:57,107 - data_loader - INFO -   Median: 50.50 chars
2025-11-12 09:05:57,113 - data_loader - INFO - 
Evidence lengths:
2025-11-12 09:05:57,113 - data_loader - INFO -   Mean: 5515.01 chars
2025-11-12 09:05:57,113 - data_loader - INFO -   Min: 1552 chars
2025-11-12 09:05:57,113 - data_loader - INFO -   Max: 25154 chars
2025-11-12 09:05:57,113 - data_loader - INFO -   Median: 4729.00 chars
2025-11-12 09:05:57,114 - data_loader - INFO - 
Missing values:
2025-11-12 09:05:57,114 - data_loader - INFO -   question_reasoning: 50 (33.33%)
2025-11-12 09:05:57,114 - data_loader - INFO -   domain_question_num: 100 (66.67%)
2025-11-12 09:05:57,114 - data_loader - INFO -   justification: 50 (33.33%)
2025-11-12 09:05:57,115 - data_loader - INFO - ================================================================================
2025-11-12 09:05:57,122 - data_loader - INFO - Retrieved batch of 150 examples
2025-11-12 09:05:57,142 - RAGExperiment - INFO - Processing 150 samples
2025-11-12 09:05:57,142 - RAGExperiment - INFO - 
================================================================================
2025-11-12 09:05:57,142 - RAGExperiment - INFO - RUNNING SINGLE VECTOR STORE EXPERIMENT (LangChain + FAISS)
2025-11-12 09:05:57,142 - RAGExperiment - INFO - ================================================================================
2025-11-12 09:05:57,142 - RAGExperiment - INFO - Processing 84 unique documents
2025-11-12 09:05:57,142 - RAGExperiment - INFO - 
================================================================================
2025-11-12 09:05:57,142 - RAGExperiment - INFO - Document: 3M_2018_10K
2025-11-12 09:05:57,142 - RAGExperiment - INFO - Samples: 2
2025-11-12 09:05:57,142 - RAGExperiment - INFO - ================================================================================
2025-11-12 09:05:57,143 - RAGExperiment - INFO - 
Chunking Statistics (LangChain):
2025-11-12 09:05:57,143 - RAGExperiment - INFO -   Total chunks: 15
2025-11-12 09:05:57,143 - RAGExperiment - INFO -   Avg chunk size: 479.40 chars
2025-11-12 09:05:57,143 - RAGExperiment - INFO -   Min chunk size: 97 chars
2025-11-12 09:05:57,143 - RAGExperiment - INFO -   Max chunk size: 511 chars
2025-11-12 09:05:57,156 - RAGExperiment - INFO -   Median chunk size: 507.00 chars
2025-11-12 09:05:57,156 - RAGExperiment - DEBUG - 
First 3 chunks preview:
2025-11-12 09:05:57,156 - RAGExperiment - DEBUG -   Chunk 0: [{'evidence_text': 'Table of Contents \n3M Company and Subsidiaries\nConsolidated Statement of Cash ...
2025-11-12 09:05:57,156 - RAGExperiment - DEBUG -     Metadata: {'doc_name': '3M_2018_10K', 'source': 'evidence'}
2025-11-12 09:05:57,156 - RAGExperiment - DEBUG -   Chunk 1: and amortization\n \n \n1,488 \n \n1,544 \n \n1,474 \nCompany pension and postretirement contributio...
2025-11-12 09:05:57,156 - RAGExperiment - DEBUG -     Metadata: {'doc_name': '3M_2018_10K', 'source': 'evidence'}
2025-11-12 09:05:57,156 - RAGExperiment - DEBUG -   Chunk 2: receivable\n \n \n(305) \n \n(245) \n \n(313) \nInventories\n \n \n(509) \n \n(387) \n \n57 \nAccoun...
2025-11-12 09:05:57,156 - RAGExperiment - DEBUG -     Metadata: {'doc_name': '3M_2018_10K', 'source': 'evidence'}
2025-11-12 09:05:57,156 - RAGExperiment - INFO - 
Creating FAISS vector store '3M_2018_10K' with 15 documents...
2025-11-12 09:05:58,963 - faiss.loader - DEBUG - Environment variable FAISS_OPT_LEVEL is not set, so let's pick the instruction set according to the current CPU
2025-11-12 09:05:58,963 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-11-12 09:05:59,220 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-11-12 09:05:59,275 - RAGExperiment - INFO - ✓ FAISS vector store created with 15 vectors
2025-11-12 09:05:59,284 - RAGExperiment - INFO - ✓ Vector store saved to: vector_stores/3M_2018_10K_20251112_090559
2025-11-12 09:05:59,284 - RAGExperiment - INFO - 
--- Sample 1/2 for 3M_2018_10K ---
2025-11-12 09:05:59,284 - RAGExperiment - INFO - 
Retrieving top-3 chunks for query: What is the FY2018 capital expenditure amount (in USD millions) for 3M? Give a response to the quest...
2025-11-12 09:05:59,322 - RAGExperiment - INFO - Retrieved 3 chunks:
2025-11-12 09:05:59,322 - RAGExperiment - INFO -   Rank 1: Score=0.9227, Length=503 chars
2025-11-12 09:05:59,322 - RAGExperiment - INFO -     Metadata: {'doc_name': '3M_2018_10K', 'source': 'evidence'}
2025-11-12 09:05:59,322 - RAGExperiment - INFO -     Text preview: statement.\n \n60', 'doc_name': '3M_2018_10K', 'evidence_page_num': 59, 'evidence_text_full_page': 'Table of Contents \n3M Company and Subsidiaries\nC...
2025-11-12 09:05:59,322 - RAGExperiment - INFO -   Rank 2: Score=0.9953, Length=500 chars
2025-11-12 09:05:59,322 - RAGExperiment - INFO -     Metadata: {'doc_name': '3M_2018_10K', 'source': 'evidence'}
2025-11-12 09:05:59,322 - RAGExperiment - INFO -     Text preview: of exchange rate changes on cash and cash equivalents\n \n \n(160) \n \n156 \n \n(33) \n \n \n \n \n \n \n \n \nNet increase (decrease) in cash and ca...
2025-11-12 09:05:59,322 - RAGExperiment - INFO -   Rank 3: Score=1.1628, Length=510 chars
2025-11-12 09:05:59,322 - RAGExperiment - INFO -     Metadata: {'doc_name': '3M_2018_10K', 'source': 'evidence'}
2025-11-12 09:05:59,322 - RAGExperiment - INFO -     Text preview: [{'evidence_text': 'Table of Contents \n3M Company and Subsidiaries\nConsolidated Statement of Cash Flow s\nYears ended December 31\n \n(Millions)\n \...
2025-11-12 09:05:59,325 - evaluator - INFO - SacreBLEU initialized successfully
2025-11-12 09:05:59,325 - absl - INFO - Using default tokenizer.
2025-11-12 09:05:59,325 - evaluator - INFO - ROUGE scorer initialized successfully
2025-11-12 09:05:59,325 - evaluator - INFO - Evaluator initialized - BLEU: True, ROUGE: True, BERTScore: False, LLM Judge: False
2025-11-12 09:05:59,326 - RAGExperiment - INFO - ================================================================================
2025-11-12 09:05:59,326 - RAGExperiment - INFO - INITIALIZING RAG EXPERIMENT: SINGLE_VECTOR
2025-11-12 09:05:59,326 - RAGExperiment - INFO - ================================================================================
2025-11-12 09:05:59,326 - RAGExperiment - INFO - Configuration:
2025-11-12 09:05:59,326 - RAGExperiment - INFO -   Experiment Type: single_vector
2025-11-12 09:05:59,326 - RAGExperiment - INFO -   LLM Model: Qwen/Qwen2.5-7B-Instruct
2025-11-12 09:05:59,326 - RAGExperiment - INFO -   Judge Model: Disabled
2025-11-12 09:05:59,326 - RAGExperiment - INFO -   Device: cuda
2025-11-12 09:05:59,326 - RAGExperiment - INFO -   8-bit Loading: True
2025-11-12 09:05:59,326 - RAGExperiment - INFO -   Chunk Size: 512
2025-11-12 09:05:59,326 - RAGExperiment - INFO -   Chunk Overlap: 50
2025-11-12 09:05:59,326 - RAGExperiment - INFO -   Top-K Retrieval: 3
2025-11-12 09:05:59,327 - RAGExperiment - INFO -   Embedding Model: sentence-transformers/all-MiniLM-L6-v2
2025-11-12 09:05:59,327 - RAGExperiment - INFO -   Max New Tokens: 256
2025-11-12 09:05:59,327 - RAGExperiment - INFO -   Using LangChain + FAISS + HuggingFace LLMs
2025-11-12 09:05:59,327 - RAGExperiment - INFO - ================================================================================
2025-11-12 09:05:59,327 - RAGExperiment - INFO - 
Initializing LangChain components...
2025-11-12 09:05:59,327 - RAGExperiment - INFO - Loading embeddings: sentence-transformers/all-MiniLM-L6-v2
2025-11-12 09:05:59,329 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-11-12 09:05:59,529 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /sentence-transformers/all-MiniLM-L6-v2/resolve/main/modules.json HTTP/1.1" 307 0
2025-11-12 09:05:59,635 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/modules.json HTTP/1.1" 200 0
2025-11-12 09:05:59,840 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /sentence-transformers/all-MiniLM-L6-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 307 0
2025-11-12 09:05:59,946 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/config_sentence_transformers.json HTTP/1.1" 200 0
2025-11-12 09:06:00,150 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /sentence-transformers/all-MiniLM-L6-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 307 0
2025-11-12 09:06:00,255 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/config_sentence_transformers.json HTTP/1.1" 200 0
2025-11-12 09:06:00,461 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /sentence-transformers/all-MiniLM-L6-v2/resolve/main/README.md HTTP/1.1" 307 0
2025-11-12 09:06:00,575 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/README.md HTTP/1.1" 200 0
2025-11-12 09:06:00,795 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /sentence-transformers/all-MiniLM-L6-v2/resolve/main/modules.json HTTP/1.1" 307 0
2025-11-12 09:06:00,901 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/modules.json HTTP/1.1" 200 0
2025-11-12 09:06:01,104 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /sentence-transformers/all-MiniLM-L6-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 307 0
2025-11-12 09:06:01,240 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/sentence_bert_config.json HTTP/1.1" 200 0
2025-11-12 09:06:01,446 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /sentence-transformers/all-MiniLM-L6-v2/resolve/main/adapter_config.json HTTP/1.1" 404 0
2025-11-12 09:06:01,688 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /sentence-transformers/all-MiniLM-L6-v2/resolve/main/config.json HTTP/1.1" 307 0
2025-11-12 09:06:01,803 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/config.json HTTP/1.1" 200 0
2025-11-12 09:06:02,032 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /sentence-transformers/all-MiniLM-L6-v2/resolve/main/tokenizer_config.json HTTP/1.1" 307 0
2025-11-12 09:06:02,146 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/tokenizer_config.json HTTP/1.1" 200 0
2025-11-12 09:06:02,356 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/sentence-transformers/all-MiniLM-L6-v2/tree/main/additional_chat_templates?recursive=False&expand=False HTTP/1.1" 404 64
2025-11-12 09:06:02,647 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /sentence-transformers/all-MiniLM-L6-v2/resolve/main/1_Pooling/config.json HTTP/1.1" 307 0
2025-11-12 09:06:02,763 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/1_Pooling%2Fconfig.json HTTP/1.1" 200 0
2025-11-12 09:06:02,975 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/sentence-transformers/all-MiniLM-L6-v2 HTTP/1.1" 200 6861
2025-11-12 09:06:02,993 - RAGExperiment - INFO - ✓ Embeddings loaded
2025-11-12 09:06:02,993 - RAGExperiment - INFO - ✓ Text splitter initialized (chunk_size=512, overlap=50)
2025-11-12 09:06:02,993 - RAGExperiment - INFO - 
================================================================================
2025-11-12 09:06:02,993 - RAGExperiment - INFO - STARTING EXPERIMENT
2025-11-12 09:06:02,993 - RAGExperiment - INFO - ================================================================================
2025-11-12 09:06:02,993 - data_loader - INFO - Loading FinanceBench dataset: PatronusAI/financebench, split: train
2025-11-12 09:06:03,215 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /datasets/PatronusAI/financebench/resolve/main/README.md HTTP/1.1" 307 0
2025-11-12 09:06:03,328 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /api/resolve-cache/datasets/PatronusAI/financebench/e04404e3a97f69f79c14d42f24981a1c9c3bcd18/README.md HTTP/1.1" 200 0
2025-11-12 09:06:03,533 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /datasets/PatronusAI/financebench/resolve/e04404e3a97f69f79c14d42f24981a1c9c3bcd18/financebench.py HTTP/1.1" 404 0
2025-11-12 09:06:03,539 - urllib3.connectionpool - DEBUG - Resetting dropped connection: s3.amazonaws.com
2025-11-12 09:06:03,618 - urllib3.connectionpool - DEBUG - https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/PatronusAI/financebench/PatronusAI/financebench.py HTTP/1.1" 404 0
2025-11-12 09:06:03,879 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /datasets/PatronusAI/financebench/resolve/e04404e3a97f69f79c14d42f24981a1c9c3bcd18/.huggingface.yaml HTTP/1.1" 404 0
2025-11-12 09:06:03,948 - urllib3.connectionpool - DEBUG - https://datasets-server.huggingface.co:443 "GET /info?dataset=PatronusAI/financebench HTTP/1.1" 200 None
2025-11-12 09:06:04,154 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/datasets/PatronusAI/financebench/tree/e04404e3a97f69f79c14d42f24981a1c9c3bcd18/data?recursive=True&expand=False HTTP/1.1" 404 79
2025-11-12 09:06:04,366 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /datasets/PatronusAI/financebench/resolve/e04404e3a97f69f79c14d42f24981a1c9c3bcd18/dataset_infos.json HTTP/1.1" 404 0
2025-11-12 09:06:04,371 - filelock - DEBUG - Attempting to acquire lock 140094495208976 on /u/kobeissa/.cache/huggingface/datasets/_u_kobeissa_.cache_huggingface_datasets_PatronusAI___financebench_default_0.0.0_e04404e3a97f69f79c14d42f24981a1c9c3bcd18.lock
2025-11-12 09:06:04,373 - filelock - DEBUG - Lock 140094495208976 acquired on /u/kobeissa/.cache/huggingface/datasets/_u_kobeissa_.cache_huggingface_datasets_PatronusAI___financebench_default_0.0.0_e04404e3a97f69f79c14d42f24981a1c9c3bcd18.lock
2025-11-12 09:06:04,374 - fsspec.local - DEBUG - open file: /u/kobeissa/.cache/huggingface/datasets/PatronusAI___financebench/default/0.0.0/e04404e3a97f69f79c14d42f24981a1c9c3bcd18/dataset_info.json
2025-11-12 09:06:04,375 - filelock - DEBUG - Attempting to release lock 140094495208976 on /u/kobeissa/.cache/huggingface/datasets/_u_kobeissa_.cache_huggingface_datasets_PatronusAI___financebench_default_0.0.0_e04404e3a97f69f79c14d42f24981a1c9c3bcd18.lock
2025-11-12 09:06:04,375 - filelock - DEBUG - Lock 140094495208976 released on /u/kobeissa/.cache/huggingface/datasets/_u_kobeissa_.cache_huggingface_datasets_PatronusAI___financebench_default_0.0.0_e04404e3a97f69f79c14d42f24981a1c9c3bcd18.lock
2025-11-12 09:06:04,376 - filelock - DEBUG - Attempting to acquire lock 140094494236464 on /u/kobeissa/.cache/huggingface/datasets/PatronusAI___financebench/default/0.0.0/e04404e3a97f69f79c14d42f24981a1c9c3bcd18_builder.lock
2025-11-12 09:06:04,378 - filelock - DEBUG - Lock 140094494236464 acquired on /u/kobeissa/.cache/huggingface/datasets/PatronusAI___financebench/default/0.0.0/e04404e3a97f69f79c14d42f24981a1c9c3bcd18_builder.lock
2025-11-12 09:06:04,378 - fsspec.local - DEBUG - open file: /u/kobeissa/.cache/huggingface/datasets/PatronusAI___financebench/default/0.0.0/e04404e3a97f69f79c14d42f24981a1c9c3bcd18/dataset_info.json
2025-11-12 09:06:04,379 - filelock - DEBUG - Attempting to release lock 140094494236464 on /u/kobeissa/.cache/huggingface/datasets/PatronusAI___financebench/default/0.0.0/e04404e3a97f69f79c14d42f24981a1c9c3bcd18_builder.lock
2025-11-12 09:06:04,380 - filelock - DEBUG - Lock 140094494236464 released on /u/kobeissa/.cache/huggingface/datasets/PatronusAI___financebench/default/0.0.0/e04404e3a97f69f79c14d42f24981a1c9c3bcd18_builder.lock
2025-11-12 09:06:04,384 - data_loader - INFO - Successfully loaded 150 examples
2025-11-12 09:06:04,384 - data_loader - INFO - Columns available: ['financebench_id', 'company', 'doc_name', 'question_type', 'question_reasoning', 'domain_question_num', 'question', 'answer', 'justification', 'dataset_subset_label', 'evidence', 'gics_sector', 'doc_type', 'doc_period', 'doc_link']
2025-11-12 09:06:04,384 - data_loader - INFO - ================================================================================
2025-11-12 09:06:04,384 - data_loader - INFO - DATASET STATISTICS
2025-11-12 09:06:04,384 - data_loader - INFO - ================================================================================
2025-11-12 09:06:04,384 - data_loader - INFO - Total examples: 150
2025-11-12 09:06:04,384 - data_loader - INFO - Columns: ['financebench_id', 'company', 'doc_name', 'question_type', 'question_reasoning', 'domain_question_num', 'question', 'answer', 'justification', 'dataset_subset_label', 'evidence', 'gics_sector', 'doc_type', 'doc_period', 'doc_link']
2025-11-12 09:06:04,384 - data_loader - INFO - ✓ Column 'question' present
2025-11-12 09:06:04,384 - data_loader - INFO - ✓ Column 'answer' present
2025-11-12 09:06:04,384 - data_loader - INFO - ✓ Column 'evidence' present
2025-11-12 09:06:04,384 - data_loader - INFO - ✓ Column 'doc_name' present
2025-11-12 09:06:04,385 - data_loader - INFO - 
Question lengths:
2025-11-12 09:06:04,385 - data_loader - INFO -   Mean: 161.09 chars
2025-11-12 09:06:04,385 - data_loader - INFO -   Min: 44 chars
2025-11-12 09:06:04,385 - data_loader - INFO -   Max: 592 chars
2025-11-12 09:06:04,385 - data_loader - INFO -   Median: 137.50 chars
2025-11-12 09:06:04,386 - data_loader - INFO - 
Answer lengths:
2025-11-12 09:06:04,386 - data_loader - INFO -   Mean: 78.19 chars
2025-11-12 09:06:04,386 - data_loader - INFO -   Min: 1 chars
2025-11-12 09:06:04,386 - data_loader - INFO -   Max: 609 chars
2025-11-12 09:06:04,386 - data_loader - INFO -   Median: 50.50 chars
2025-11-12 09:06:04,392 - data_loader - INFO - 
Evidence lengths:
2025-11-12 09:06:04,392 - data_loader - INFO -   Mean: 5515.01 chars
2025-11-12 09:06:04,392 - data_loader - INFO -   Min: 1552 chars
2025-11-12 09:06:04,392 - data_loader - INFO -   Max: 25154 chars
2025-11-12 09:06:04,392 - data_loader - INFO -   Median: 4729.00 chars
2025-11-12 09:06:04,392 - data_loader - INFO - 
Missing values:
2025-11-12 09:06:04,393 - data_loader - INFO -   question_reasoning: 50 (33.33%)
2025-11-12 09:06:04,393 - data_loader - INFO -   domain_question_num: 100 (66.67%)
2025-11-12 09:06:04,393 - data_loader - INFO -   justification: 50 (33.33%)
2025-11-12 09:06:04,393 - data_loader - INFO - ================================================================================
2025-11-12 09:06:04,393 - data_loader - INFO - Retrieved batch of 150 examples
2025-11-12 09:06:04,395 - RAGExperiment - INFO - Processing 150 samples
2025-11-12 09:06:04,395 - RAGExperiment - INFO - 
================================================================================
2025-11-12 09:06:04,395 - RAGExperiment - INFO - RUNNING SINGLE VECTOR STORE EXPERIMENT (LangChain + FAISS)
2025-11-12 09:06:04,395 - RAGExperiment - INFO - ================================================================================
2025-11-12 09:06:04,395 - RAGExperiment - INFO - Processing 84 unique documents
2025-11-12 09:06:04,395 - RAGExperiment - INFO - 
================================================================================
2025-11-12 09:06:04,395 - RAGExperiment - INFO - Document: 3M_2018_10K
2025-11-12 09:06:04,395 - RAGExperiment - INFO - Samples: 2
2025-11-12 09:06:04,395 - RAGExperiment - INFO - ================================================================================
2025-11-12 09:06:04,396 - RAGExperiment - INFO - 
Chunking Statistics (LangChain):
2025-11-12 09:06:04,396 - RAGExperiment - INFO -   Total chunks: 15
2025-11-12 09:06:04,396 - RAGExperiment - INFO -   Avg chunk size: 479.40 chars
2025-11-12 09:06:04,396 - RAGExperiment - INFO -   Min chunk size: 97 chars
2025-11-12 09:06:04,396 - RAGExperiment - INFO -   Max chunk size: 511 chars
2025-11-12 09:06:04,396 - RAGExperiment - INFO -   Median chunk size: 507.00 chars
2025-11-12 09:06:04,396 - RAGExperiment - DEBUG - 
First 3 chunks preview:
2025-11-12 09:06:04,396 - RAGExperiment - DEBUG -   Chunk 0: [{'evidence_text': 'Table of Contents \n3M Company and Subsidiaries\nConsolidated Statement of Cash ...
2025-11-12 09:06:04,396 - RAGExperiment - DEBUG -     Metadata: {'doc_name': '3M_2018_10K', 'source': 'evidence'}
2025-11-12 09:06:04,396 - RAGExperiment - DEBUG -   Chunk 1: and amortization\n \n \n1,488 \n \n1,544 \n \n1,474 \nCompany pension and postretirement contributio...
2025-11-12 09:06:04,396 - RAGExperiment - DEBUG -     Metadata: {'doc_name': '3M_2018_10K', 'source': 'evidence'}
2025-11-12 09:06:04,397 - RAGExperiment - DEBUG -   Chunk 2: receivable\n \n \n(305) \n \n(245) \n \n(313) \nInventories\n \n \n(509) \n \n(387) \n \n57 \nAccoun...
2025-11-12 09:06:04,397 - RAGExperiment - DEBUG -     Metadata: {'doc_name': '3M_2018_10K', 'source': 'evidence'}
2025-11-12 09:06:04,397 - RAGExperiment - INFO - 
Creating FAISS vector store '3M_2018_10K' with 15 documents...
2025-11-12 09:06:04,412 - RAGExperiment - INFO - ✓ FAISS vector store created with 15 vectors
2025-11-12 09:06:04,421 - RAGExperiment - INFO - ✓ Vector store saved to: vector_stores/3M_2018_10K_20251112_090604
2025-11-12 09:06:04,421 - RAGExperiment - INFO - 
--- Sample 1/2 for 3M_2018_10K ---
2025-11-12 09:06:04,421 - RAGExperiment - INFO - 
Retrieving top-3 chunks for query: What is the FY2018 capital expenditure amount (in USD millions) for 3M? Give a response to the quest...
2025-11-12 09:06:04,425 - RAGExperiment - INFO - Retrieved 3 chunks:
2025-11-12 09:06:04,425 - RAGExperiment - INFO -   Rank 1: Score=0.9227, Length=503 chars
2025-11-12 09:06:04,425 - RAGExperiment - INFO -     Metadata: {'doc_name': '3M_2018_10K', 'source': 'evidence'}
2025-11-12 09:06:04,425 - RAGExperiment - INFO -     Text preview: statement.\n \n60', 'doc_name': '3M_2018_10K', 'evidence_page_num': 59, 'evidence_text_full_page': 'Table of Contents \n3M Company and Subsidiaries\nC...
2025-11-12 09:06:04,425 - RAGExperiment - INFO -   Rank 2: Score=0.9953, Length=500 chars
2025-11-12 09:06:04,425 - RAGExperiment - INFO -     Metadata: {'doc_name': '3M_2018_10K', 'source': 'evidence'}
2025-11-12 09:06:04,425 - RAGExperiment - INFO -     Text preview: of exchange rate changes on cash and cash equivalents\n \n \n(160) \n \n156 \n \n(33) \n \n \n \n \n \n \n \n \nNet increase (decrease) in cash and ca...
2025-11-12 09:06:04,425 - RAGExperiment - INFO -   Rank 3: Score=1.1628, Length=510 chars
2025-11-12 09:06:04,425 - RAGExperiment - INFO -     Metadata: {'doc_name': '3M_2018_10K', 'source': 'evidence'}
2025-11-12 09:06:04,425 - RAGExperiment - INFO -     Text preview: [{'evidence_text': 'Table of Contents \n3M Company and Subsidiaries\nConsolidated Statement of Cash Flow s\nYears ended December 31\n \n(Millions)\n \...
